# requires libraries
# if needed: install.packages("ggseqlogo")
library(msa)
require(ggplot2)
require(ggseqlogo)

# load in sequences and reun ClustalW alignment
MySequences <- readAAStringSet("sequences.fasta")
Alignment <- msa(MySequences)

# convert for processing
Alignment2 <- msaConvert(Alignment, type="seqinr::alignment")

# output of complete sequence alignment
print(Alignment, show="complete")

# create objects
names <- Alignment2$nam
sequences <-Alignment2$seq


# run ggseqlogo

# split sequnces into smaller segments for wrapping of sequence
num.chars <- nchar(sequences[1])
starts <- seq(1, num.chars, by=80)
fragments <- sapply(starts, function(ii) {
  list(substr(sequences, ii, ii+79))
})

# determine number of rows and print protein logo
rows <- length(fragments)
ggseqlogo(fragments, method="bits", nrow=rows)
