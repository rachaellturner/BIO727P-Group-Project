#packages used
import matplotlib.pyplot as plt
import numpy as np

from collections import Counter


ORF0_list = [('L1PA2', 'chr1'), ('L1HS', 'chr1'), ('L1PA2', 'chr1'), ('L1PA2', 'chr1'), ('L1PA2', 'chr1'), ('L1PA2', 'chr1'), ('L1PA2', 'chr1'), ('L1PA2', 'chr1'), ('L1HS', 'chr1'), ('L1HS', 'chr1'), ('L1PA2', 'chr1'), ('L1PA2', 'chr1'), ('L1PA2', 'chr1'), ('L1PA2', 'chr1'), ('L1HS', 'chr1'), ('L1HS', 'chr1'), ('L1PA2', 'chr1'), ('L1HS', 'chr1'), ('L1HS', 'chr1'), ('L1HS', 'chr1'), ('L1HS', 'chr1'), ('L1HS', 'chr1'), ('L1PA2', 'chr1'), ('L1PA3', 'chr1'), ('L1PA2', 'chr1'), ('L1PA2', 'chr1'), ('L1PA2', 'chr1'), ('L1HS', 'chr1'), ('L1PA2', 'chr1'), ('L1PA2', 'chr1'), ('L1HS', 'chr1'), ('L1HS', 'chr1'), ('L1HS', 'chr1'), ('L1PA2', 'chr1'), ('L1HS', 'chr1'), ('L1HS', 'chr1'), ('L1HS', 'chr1'), ('L1HS', 'chr1'), ('L1PA2', 'chr1'), ('L1HS', 'chr1'), ('L1HS', 'chr1'), ('L1HS', 'chr1'), ('L1HS', 'chr1'), ('L1PA2', 'chr1'), ('L1PA3', 'chr1'), ('L1PA2', 'chr2'), ('L1HS', 'chr2'), ('L1HS', 'chr2'), ('L1HS', 'chr2'), ('L1PA2', 'chr2'), ('L1PA2', 'chr2'), ('L1HS', 'chr2'), ('L1HS', 'chr2'), ('L1PA2', 'chr2'), ('L1PA2', 'chr2'), ('L1PA2', 'chr2'), ('L1PA2', 'chr2'), ('L1PA2', 'chr2'), ('L1HS', 'chr2'), ('L1HS', 'chr2'), ('L1PA3', 'chr2'), ('L1PA2', 'chr2'), ('L1PA2', 'chr2'), ('L1PA2', 'chr2'), ('L1HS', 'chr2'), ('L1PA2', 'chr2'), ('L1HS', 'chr2'), ('L1PA2', 'chr2'), ('L1PA2', 'chr2'), ('L1PA3', 'chr2'), ('L1PA2', 'chr2'), ('L1PA2', 'chr2'), ('L1PA2', 'chr2'), ('L1HS', 'chr2'), ('L1PA2', 'chr2'), ('L1PA2', 'chr2'), ('L1HS', 'chr2'), ('L1HS', 'chr2'), ('L1HS', 'chr2'), ('L1HS', 'chr2'), ('L1HS', 'chr2'), ('L1HS', 'chr2'), ('L1PA2', 'chr2'), ('L1PA3', 'chr2'), ('L1HS', 'chr2'), ('L1PA2', 'chr2'), ('L1HS', 'chr2'), ('L1PA2', 'chr2'), ('L1PA3', 'chr2'), ('L1PA2', 'chr2'), ('L1HS', 'chr2'), ('L1PA2', 'chr2'), ('L1PA2', 'chr3'), ('L1HS', 'chr3'), ('L1PA2', 'chr3'), ('L1PA2', 'chr3'), ('L1PA2', 'chr3'), ('L1HS', 'chr3'), ('L1HS', 'chr3'), ('L1PA3', 'chr3'), ('L1PA2', 'chr3'), ('L1HS', 'chr3'), ('L1PA2', 'chr3'), ('L1HS', 'chr3'), ('L1PA2', 'chr3'), ('L1HS', 'chr3'), ('L1PA2', 'chr3'), ('L1HS', 'chr3'), ('L1PA3', 'chr3'), ('L1PA3', 'chr3'), ('L1HS', 'chr3'), ('L1HS', 'chr3'), ('L1PA2', 'chr3'), ('L1PA2', 'chr3'), ('L1PA2', 'chr3'), ('L1HS', 'chr3'), ('L1HS', 'chr3'), ('L1HS', 'chr3'), ('L1HS', 'chr3'), ('L1PA2', 'chr3'), ('L1PA2', 'chr3'), ('L1HS', 'chr3'), ('L1HS', 'chr3'), ('L1PA2', 'chr3'), ('L1HS', 'chr3'), ('L1HS', 'chr3'), ('L1PA3', 'chr3'), ('L1PA2', 'chr3'), ('L1PA2', 'chr3'), ('L1PA2', 'chr3'), ('L1PA2', 'chr3'), ('L1PA2', 'chr3'), ('L1PA2', 'chr4'), ('L1PA2', 'chr4'), ('L1HS', 'chr4'), ('L1PA3', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1PA2', 'chr4'), ('L1PA2', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1PA2', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1PA2', 'chr4'), ('L1PA2', 'chr4'), ('L1PA2', 'chr4'), ('L1PA2', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1PA2', 'chr4'), ('L1PA2', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1PA2', 'chr4'), ('L1PA2', 'chr4'), ('L1PA2', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr4'), ('L1HS', 'chr5'), ('L1HS', 'chr5'), ('L1PA2', 'chr5'), ('L1HS', 'chr5'), ('L1PA2', 'chr5'), ('L1PA2', 'chr5'), ('L1PA2', 'chr5'), ('L1PA2', 'chr5'), ('L1HS', 'chr5'), ('L1PA2', 'chr5'), ('L1PA2', 'chr5'), ('L1PA3', 'chr5'), ('L1HS', 'chr5'), ('L1PA3', 'chr5'), ('L1PA2', 'chr5'), ('L1PA2', 'chr5'), ('L1PA2', 'chr5'), ('L1HS', 'chr5'), ('L1HS', 'chr5'), ('L1HS', 'chr5'), ('L1PA2', 'chr5'), ('L1PA4', 'chr5'), ('L1PA2', 'chr5'), ('L1PA2', 'chr5'), ('L1HS', 'chr5'), ('L1HS', 'chr5'), ('L1PA2', 'chr5'), ('L1HS', 'chr5'), ('L1HS', 'chr5'), ('L1HS', 'chr5'), ('L1HS', 'chr5'), ('L1P1', 'chr5'), ('L1HS', 'chr5'), ('L1PA2', 'chr5'), ('L1PA2', 'chr5'), ('L1HS', 'chr5'), ('L1PA2', 'chr5'), ('L1PA2', 'chr5'), ('L1HS', 'chr5'), ('L1PA2', 'chr5'), ('L1HS', 'chr5'), ('L1PA6', 'chr5'), ('L1HS', 'chr5'), ('L1PA2', 'chr5'), ('L1HS', 'chr5'), ('L1HS', 'chr6'), ('L1HS', 'chr6'), ('L1HS', 'chr6'), ('L1PA2', 'chr6'), ('L1PA2', 'chr6'), ('L1PA2', 'chr6'), ('L1HS', 'chr6'), ('L1HS', 'chr6'), ('L1HS', 'chr6'), ('L1HS', 'chr6'), ('L1HS', 'chr6'), ('L1PA2', 'chr6'), ('L1HS', 'chr6'), ('L1HS', 'chr6'), ('L1PA2', 'chr6'), ('L1PA2', 'chr6'), ('L1PA2', 'chr6'), ('L1PA2', 'chr6'), ('L1HS', 'chr6'), ('L1PA3', 'chr6'), ('L1HS', 'chr6'), ('L1HS', 'chr6'), ('L1HS', 'chr6'), ('L1HS', 'chr6'), ('L1HS', 'chr6'), ('L1PA2', 'chr6'), ('L1PA2', 'chr6'), ('L1HS', 'chr7'), ('L1PA2', 'chr7'), ('L1HS', 'chr7'), ('L1PA2', 'chr7'), ('L1HS', 'chr7'), ('L1HS', 'chr7'), ('L1HS', 'chr7'), ('L1HS', 'chr7'), ('L1HS', 'chr7'), ('L1HS', 'chr7'), ('L1PA2', 'chr7'), ('L1PA2', 'chr7'), ('L1PA3', 'chr7'), ('L1HS', 'chr7'), ('L1HS', 'chr7'), ('L1HS', 'chr7'), ('L1PA2', 'chr7'), ('L1HS', 'chr7'), ('L1HS', 'chr7'), ('L1HS', 'chr7'), ('L1PA2', 'chr7'), ('L1PA2', 'chr7'), ('L1HS', 'chr7'), ('L1HS', 'chr7'), ('L1HS', 'chr8'), ('L1PA2', 'chr8'), ('L1HS', 'chr8'), ('L1PA2', 'chr8'), ('L1PA2', 'chr8'), ('L1HS', 'chr8'), ('L1PA2', 'chr8'), ('L1PA2', 'chr8'), ('L1PA2', 'chr8'), ('L1PA2', 'chr8'), ('L1PA2', 'chr8'), ('L1PA2', 'chr8'), ('L1PA2', 'chr8'), ('L1HS', 'chr8'), ('L1HS', 'chr8'), ('L1PA2', 'chr8'), ('L1PA2', 'chr8'), ('L1PA2', 'chr8'), ('L1HS', 'chr8'), ('L1HS', 'chr8'), ('L1HS', 'chr8'), ('L1HS', 'chr8'), ('L1PA2', 'chr8'), ('L1HS', 'chr8'), ('L1HS', 'chr8'), ('L1PA4', 'chr9'), ('L1PA2', 'chr9'), ('L1PA2', 'chr9'), ('L1PA2', 'chr9'), ('L1PA4', 'chr9'), ('L1HS', 'chr9'), ('L1PA2', 'chr9'), ('L1PA4', 'chr9'), ('L1HS', 'chr9'), ('L1HS', 'chr9'), ('L1HS', 'chr9'), ('L1PA2', 'chr9'), ('L1PA2', 'chr9'), ('L1HS', 'chr9'), ('L1HS', 'chr9'), ('L1PA7', 'chr9'), ('L1PA2', 'chr9'), ('L1HS', 'chrX'), ('L1PA2', 'chrX'), ('L1PA2', 'chrX'), ('L1HS', 'chrX'), ('L1HS', 'chrX'), ('L1PA2', 'chrX'), ('L1PA2', 'chrX'), ('L1PA2', 'chrX'), ('L1HS', 'chrX'), ('L1HS', 'chrX'), ('L1PA2', 'chrX'), ('L1PA2', 'chrX'), ('L1PA2', 'chrX'), ('L1HS', 'chrX'), ('L1PA2', 'chrX'), ('L1PA2', 'chrX'), ('L1HS', 'chrX'), ('L1PA2', 'chrX'), ('L1HS', 'chrX'), ('L1PA4', 'chrX'), ('L1PA3', 'chrX'), ('L1PA2', 'chrX'), ('L1HS', 'chrX'), ('L1HS', 'chrX'), ('L1PA2', 'chrX'), ('L1PA2', 'chrX'), ('L1HS', 'chrX'), ('L1HS', 'chrX'), ('L1HS', 'chrX'), ('L1PA2', 'chrX'), ('L1PA2', 'chrX'), ('L1HS', 'chrX'), ('L1PA2', 'chrX'), ('L1PA2', 'chrX'), ('L1PA2', 'chrX'), ('L1HS', 'chrX'), ('L1PA3', 'chrX'), ('L1HS', 'chrX'), ('L1HS', 'chrX'), ('L1HS', 'chrX'), ('L1HS', 'chrX'), ('L1HS', 'chrX'), ('L1HS', 'chrY'), ('L1HS', 'chrY'), ('L1PA2', 'chrY'), ('L1HS', 'chr10'), ('L1PA2', 'chr10'), ('L1HS', 'chr10'), ('L1HS', 'chr10'), ('L1PA2', 'chr10'), ('L1PA2', 'chr10'), ('L1PA2', 'chr10'), ('L1HS', 'chr10'), ('L1HS', 'chr10'), ('L1PA2', 'chr10'), ('L1HS', 'chr10'), ('L1PA2', 'chr10'), ('L1PA2', 'chr10'), ('L1HS', 'chr10'), ('L1PA2', 'chr10'), ('L1PA2', 'chr11'), ('L1HS', 'chr11'), ('L1PA3', 'chr11'), ('L1PA2', 'chr11'), ('L1PA2', 'chr11'), ('L1HS', 'chr11'), ('L1HS', 'chr11'), ('L1PA4', 'chr11'), ('L1PA2', 'chr11'), ('L1HS', 'chr11'), ('L1PA2', 'chr11'), ('L1PA2', 'chr11'), ('L1HS', 'chr11'), ('L1HS', 'chr11'), ('L1HS', 'chr11'), ('L1PA2', 'chr11'), ('L1HS', 'chr11'), ('L1HS', 'chr11'), ('L1HS', 'chr11'), ('L1HS', 'chr11'), ('L1PA2', 'chr11'), ('L1HS', 'chr11'), ('L1PA2', 'chr11'), ('L1P1', 'chr11'), ('L1PA2', 'chr11'), ('L1PA4', 'chr11'), ('L1HS', 'chr11'), ('L1PA2', 'chr12'), ('L1HS', 'chr12'), ('L1PA3', 'chr12'), ('L1HS', 'chr12'), ('L1PA2', 'chr12'), ('L1HS', 'chr12'), ('L1HS', 'chr12'), ('L1PA2', 'chr12'), ('L1PA2', 'chr12'), ('L1PA2', 'chr12'), ('L1PA2', 'chr12'), ('L1PA3', 'chr12'), ('L1PA2', 'chr12'), ('L1PA2', 'chr12'), ('L1PA2', 'chr12'), ('L1HS', 'chr12'), ('L1HS', 'chr12'), ('L1HS', 'chr13'), ('L1HS', 'chr13'), ('L1PA2', 'chr13'), ('L1PA2', 'chr13'), ('L1PA2', 'chr13'), ('L1PA2', 'chr13'), ('L1HS', 'chr13'), ('L1HS', 'chr13'), ('L1HS', 'chr14'), ('L1HS', 'chr14'), ('L1HS', 'chr14'), ('L1HS', 'chr14'), ('L1PA2', 'chr14'), ('L1PA2', 'chr14'), ('L1HS', 'chr14'), ('L1HS', 'chr14'), ('L1HS', 'chr14'), ('L1HS', 'chr14'), ('L1PA2', 'chr14'), ('L1PA2', 'chr14'), ('L1PA2', 'chr15'), ('L1PA2', 'chr15'), ('L1HS', 'chr15'), ('L1HS', 'chr15'), ('L1PA2', 'chr15'), ('L1PA2', 'chr15'), ('L1PA2', 'chr15'), ('L1PA2', 'chr15'), ('L1PA2', 'chr15'), ('L1HS', 'chr15'), ('L1PA2', 'chr15'), ('L1PA2', 'chr15'), ('L1HS', 'chr15'), ('L1HS', 'chr16'), ('L1HS', 'chr16'), ('L1HS', 'chr16'), ('L1HS', 'chr16'), ('L1PA2', 'chr16'), ('L1HS', 'chr16'), ('L1PA3', 'chr16'), ('L1PA2', 'chr16'), ('L1HS', 'chr16'), ('L1HS', 'chr16'), ('L1PA2', 'chr16'), ('L1PA2', 'chr16'), ('L1HS', 'chr16'), ('L1HS', 'chr17'), ('L1HS', 'chr17'), ('L1PA2', 'chr17'), ('L1PA2', 'chr17'), ('L1PA2', 'chr17'), ('L1HS', 'chr17'), ('L1HS', 'chr17'), ('L1HS', 'chr17'), ('L1HS', 'chr18'), ('L1PA2', 'chr18'), ('L1HS', 'chr18'), ('L1PA2', 'chr18'), ('L1PA2', 'chr18'), ('L1PA2', 'chr18'), ('L1HS', 'chr18'), ('L1HS', 'chr18'), ('L1HS', 'chr18'), ('L1HS', 'chr18'), ('L1PA2', 'chr18'), ('L1HS', 'chr18'), ('L1HS', 'chr18'), ('L1HS', 'chr18'), ('L1HS', 'chr18'), ('L1PA2', 'chr19'), ('L1PA2', 'chr20'), ('L1PA2', 'chr20'), ('L1HS', 'chr20'), ('L1HS', 'chr20'), ('L1HS', 'chr20'), ('L1PA3', 'chr20'), ('L1HS', 'chr20'), ('L1HS', 'chr22'), ('L1HS', 'chr22'), ('L1HS', 'chr22'), ('L1HS', 'chr2_GL383521v1_alt'), ('L1HS', 'chr2_GL582966v2_alt'), ('L1HS', 'chr6_GL000253v2_alt'), ('L1PA2', 'chr8_KI270900v1_alt'), ('L1PA2', 'chr8_KI270926v1_alt'), ('L1PA4', 'chr9_GL383540v1_alt'), ('L1HS', 'chr9_GL383541v1_alt'), ('L1HS', 'chr12_GL383551v1_alt'), ('L1HS', 'chr12_GL383551v1_alt'), ('L1HS', 'chr16_KI270853v1_alt'), ('L1HS', 'chr17_GL383565v1_alt'), ('L1HS', 'chr17_GL383565v1_alt'), ('L1HS', 'chr18_GL383567v1_alt'), ('L1HS', 'chr18_GL383568v1_alt'), ('L1PA2', 'chr18_GL383570v1_alt'), ('L1HS', 'chr18_GL383570v1_alt'), ('L1HS', 'chr20_GL383577v2_alt'), ('L1HS', 'chr21_GL383579v2_alt'), ('L1HS', 'chr14_KI270725v1_random')]

#plotting frequency of repeats in chromosomes

#example file
#line_data=open("LINE1_taimur.csv", "r")
#line_data.readline()
#list of accepted chromosomes
chromosome_list=["chr1","chr2","chr3", "chr4", "chr5", "chr6", "chr7", "chr8", "chr9", "chr10", "chr11", "chr12", "chr13", "chr14", "chr15", "chr16", "chr17", "chr18", "chr19", "chr20", "chr21", "chr22", "chrX", "chrY"]
#empty list for chromosome and repName
repNamelist = []
chrlist = []

#convert example file to suitable input- edited depending on django input
#add repNames and chromosomes to lists 
"""for line in line_data:
    line = line.strip("\n\r")
    split_line = line.split(",")
    if split_line[4] in chromosome_list:
        repNamelist.append(split_line[1])
        chrlist.append(split_line[4])"""
#"""input from django (presumably) a list of tuples i.e [repName, genoName]
for entry in ORF0_list:
    if entry[1] in chromosome_list:
        repNamelist.append(entry[0])
        chrlist.append(entry[1])   
#"""
#counts frequency in list = y axis  
g=Counter(chrlist)


## Rachael Update
#crates an ordered dictionary of frequency
d=OrderedDict(g)
for test in chromosome_list:
    try:
        d.move_to_end(test)
    except:
        continue

#converts dictionaries to list to plot
nChr=d.values()
Chr = d.keys()
#range of the x axis
ChrAsX= range(len(d))
#plot(x,y)
plt.bar(ChrAsX, nChr)
#adjusting plot visualisations
plt.xticks(ChrAsX, Chr, rotation=20)
plt.xlim([min(ChrAsX)- 0.3, max(ChrAsX)+1])
plt.ylim([0,max(nChr)+5000])
plt.grid(True, axis='y')
plt.rc('xtick', labelsize=8)
plt.rc('ytick', labelsize=8)

#view plot
fig= plt.gcf()
fig.set_size_inches(10,10)
plt.show()
